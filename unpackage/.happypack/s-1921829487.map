{"version":3,"sources":["src\\static\\js\\mui.lazyload.js"],"names":["$","window","document","mid","Lazyload","Class","extend","init","element","options","self","container","selector","diff","force","autoDestroy","duration","_key","_containerIsNotDocument","nodeType","_callbacks","_init","_initLoadFn","addElements","_loadFn","ready","bind","resume","_buffer","_counter","isEmptyObject","destroy","_loadItems","_createLoader","load","value","loading","handles","h","handle","v","shift","apply","e","setTimeout","push","fn","ms","context","timer","lastStart","lastEnd","run","cancel","now","arguments","later","stop","_getBoundingRect","c","vh","vw","left","top","undefined","offsetHeight","offsetWidth","offset","innerHeight","innerWidth","pageYOffset","diffX","diffX0","diffX1","diffY","diffY0","diffY1","right","bottom","_cacheWidth","el","_mui_lazy_width","_cacheHeight","_mui_lazy_height","_isCross","r1","r2","r","Math","max","min","_elementInViewport","elem","windowRegion","containerRegion","elemOffset","inContainer","inWin","elemRegion","_windowRegion","_containerRegion","each","key","callback","_loadItem","remove","call","addCallback","callbacks","noop","refresh","elements","lazyloads","querySelectorAll","index","concat","qsa","getAttribute","addElement","setAttribute","check","pause","_destroyed","removeEventListener","EVENT_MOVE","addEventListener","trigger","mui"],"mappings":"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","file":"mui.lazyload.js","sourceRoot":"C:/Users/dell/AppData/Roaming/HBuilder/userprofiles/18710095921@163.com/appTemplate/unpackage","sourcesContent":["(function($, window, document) {\n\tvar mid = 0;\n\t$.Lazyload = $.Class.extend({\n\t\tinit: function(element, options) {\n\t\t\tvar self = this;\n\t\t\tthis.container = this.element = element;\n//\t\t\tplaceholder //默认图片\n\t\t\tthis.options = $.extend({\n\t\t\t\tselector: '',//查询哪些元素需要lazyload\n\t\t\t\tdiff: false,//距离视窗底部多少像素出发lazyload\n\t\t\t\tforce: false,//强制加载(不论元素是否在是视窗内)\n\t\t\t\tautoDestroy: true,//元素加载完后是否自动销毁当前插件对象\n\t\t\t\tduration: 100//滑动停止多久后开始加载\n\t\t\t}, options);\n\n\t\t\tthis._key = 0;\n\t\t\tthis._containerIsNotDocument = this.container.nodeType !== 9;\n\t\t\tthis._callbacks = {};\n\n\t\t\tthis._init();\n\t\t},\n\t\t_init: function() {\n\t\t\tthis._initLoadFn();\n\n\t\t\tthis.addElements();\n\n\t\t\tthis._loadFn();\n\n\t\t\t$.ready(function() {\n\t\t\t\tthis._loadFn();\n\t\t\t}.bind(this));\n\n\t\t\tthis.resume();\n\t\t},\n\t\t_initLoadFn: function() {\n\t\t\tvar self = this;\n\t\t\tself._loadFn = this._buffer(function() { // 加载延迟项\n\t\t\t\tif (self.options.autoDestroy && self._counter == 0 && $.isEmptyObject(self._callbacks)) {\n\t\t\t\t\tself.destroy();\n\t\t\t\t}\n\t\t\t\tself._loadItems();\n\t\t\t}, self.options.duration, self);\n\t\t},\n\t\t/**\n\t\t *根据加载函数实现加载器\n\t\t *@param {Function} load 加载函数\n\t\t *@returns {Function} 加载器\n\t\t */\n\t\t_createLoader: function(load) {\n\t\t\tvar value, loading, handles = [],\n\t\t\t\th;\n\t\t\treturn function(handle) {\n\t\t\t\tif (!loading) {\n\t\t\t\t\tloading = true;\n\t\t\t\t\tload(function(v) {\n\t\t\t\t\t\tvalue = v;\n\t\t\t\t\t\twhile (h = handles.shift()) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\th && h.apply(null, [value]);\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t\t\t}, 0)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif (value) {\n\t\t\t\t\thandle && handle.apply(null, [value]);\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t\thandle && handles.push(handle);\n\t\t\t\treturn value;\n\t\t\t}\n\t\t},\n\t\t_buffer: function(fn, ms, context) {\n\t\t\tvar timer;\n\t\t\tvar lastStart = 0;\n\t\t\tvar lastEnd = 0;\n\t\t\tvar ms = ms || 150;\n\n\t\t\tfunction run() {\n\t\t\t\tif (timer) {\n\t\t\t\t\ttimer.cancel();\n\t\t\t\t\ttimer = 0;\n\t\t\t\t}\n\t\t\t\tlastStart = $.now();\n\t\t\t\tfn.apply(context || this, arguments);\n\t\t\t\tlastEnd = $.now();\n\t\t\t}\n\n\t\t\treturn $.extend(function() {\n\t\t\t\tif (\n\t\t\t\t\t(!lastStart) || // 从未运行过\n\t\t\t\t\t(lastEnd >= lastStart && $.now() - lastEnd > ms) || // 上次运行成功后已经超过ms毫秒\n\t\t\t\t\t(lastEnd < lastStart && $.now() - lastStart > ms * 8) // 上次运行或未完成，后8*ms毫秒\n\t\t\t\t) {\n\t\t\t\t\trun();\n\t\t\t\t} else {\n\t\t\t\t\tif (timer) {\n\t\t\t\t\t\ttimer.cancel();\n\t\t\t\t\t}\n\t\t\t\t\ttimer = $.later(run, ms, null, arguments);\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tstop: function() {\n\t\t\t\t\tif (timer) {\n\t\t\t\t\t\ttimer.cancel();\n\t\t\t\t\t\ttimer = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t_getBoundingRect: function(c) {\n\t\t\tvar vh, vw, left, top;\n\n\t\t\tif (c !== undefined) {\n\t\t\t\tvh = c.offsetHeight;\n\t\t\t\tvw = c.offsetWidth;\n\t\t\t\tvar offset = $.offset(c);\n\t\t\t\tleft = offset.left;\n\t\t\t\ttop = offset.top;\n\t\t\t} else {\n\t\t\t\tvh = window.innerHeight;\n\t\t\t\tvw = window.innerWidth;\n\t\t\t\tleft = 0;\n\t\t\t\ttop = window.pageYOffset;\n\t\t\t}\n\n\t\t\tvar diff = this.options.diff;\n\n\t\t\tvar diffX = diff === false ? vw : diff;\n\t\t\tvar diffX0 = 0;\n\t\t\tvar diffX1 = diffX;\n\n\t\t\tvar diffY = diff === false ? vh : diff;\n\t\t\tvar diffY0 = 0;\n\t\t\tvar diffY1 = diffY;\n\n\t\t\tvar right = left + vw;\n\t\t\tvar bottom = top + vh;\n\n\n\t\t\tleft -= diffX0;\n\t\t\tright += diffX1;\n\t\t\ttop -= diffY0;\n\t\t\tbottom += diffY1;\n\t\t\treturn {\n\t\t\t\tleft: left,\n\t\t\t\ttop: top,\n\t\t\t\tright: right,\n\t\t\t\tbottom: bottom\n\t\t\t};\n\t\t},\n\t\t_cacheWidth: function(el) {\n\t\t\tif (el._mui_lazy_width) {\n\t\t\t\treturn el._mui_lazy_width;\n\t\t\t}\n\t\t\treturn el._mui_lazy_width = el.offsetWidth;\n\t\t},\n\t\t_cacheHeight: function(el) {\n\t\t\tif (el._mui_lazy_height) {\n\t\t\t\treturn el._mui_lazy_height;\n\t\t\t}\n\t\t\treturn el._mui_lazy_height = el.offsetHeight;\n\t\t},\n\t\t_isCross: function(r1, r2) {\n\t\t\tvar r = {};\n\t\t\tr.top = Math.max(r1.top, r2.top);\n\t\t\tr.bottom = Math.min(r1.bottom, r2.bottom);\n\t\t\tr.left = Math.max(r1.left, r2.left);\n\t\t\tr.right = Math.min(r1.right, r2.right);\n\t\t\treturn r.bottom >= r.top && r.right >= r.left;\n\t\t},\n\t\t_elementInViewport: function(elem, windowRegion, containerRegion) {\n\t\t\t// display none or inside display none\n\t\t\tif (!elem.offsetWidth) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar elemOffset = $.offset(elem);\n\t\t\tvar inContainer = true;\n\t\t\tvar inWin;\n\t\t\tvar left = elemOffset.left;\n\t\t\tvar top = elemOffset.top;\n\t\t\tvar elemRegion = {\n\t\t\t\tleft: left,\n\t\t\t\ttop: top,\n\t\t\t\tright: left + this._cacheWidth(elem),\n\t\t\t\tbottom: top + this._cacheHeight(elem)\n\t\t\t};\n\n\t\t\tinWin = this._isCross(windowRegion, elemRegion);\n\n\t\t\tif (inWin && containerRegion) {\n\t\t\t\tinContainer = this._isCross(containerRegion, elemRegion);\n\t\t\t}\n\t\t\t// 确保在容器内出现\n\t\t\t// 并且在视窗内也出现\n\t\t\treturn inContainer && inWin;\n\t\t},\n\t\t_loadItems: function() {\n\t\t\tvar self = this;\n\t\t\t// container is display none\n\t\t\tif (self._containerIsNotDocument && !self.container.offsetWidth) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tself._windowRegion = self._getBoundingRect();\n\n\t\t\tif (self._containerIsNotDocument) {\n\t\t\t\tself._containerRegion = self._getBoundingRect(this.container);\n\t\t\t}\n\t\t\t$.each(self._callbacks, function(key, callback) {\n\t\t\t\tcallback && self._loadItem(key, callback);\n\t\t\t});\n\t\t},\n\t\t_loadItem: function(key, callback) {\n\t\t\tvar self = this;\n\t\t\tcallback = callback || self._callbacks[key];\n\t\t\tif (!callback) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tvar el = callback.el;\n\t\t\tvar remove = false;\n\t\t\tvar fn = callback.fn;\n\t\t\tif (self.options.force || self._elementInViewport(el, self._windowRegion, self._containerRegion)) {\n\t\t\t\ttry {\n\t\t\t\t\tremove = fn.call(self, el, key);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (remove !== false) {\n\t\t\t\tdelete self._callbacks[key];\n\t\t\t}\n\t\t\treturn remove;\n\t\t},\n\t\taddCallback: function(el, fn) {\n\t\t\tvar self = this;\n\t\t\tvar callbacks = self._callbacks;\n\t\t\tvar callback = {\n\t\t\t\tel: el,\n\t\t\t\tfn: fn || $.noop\n\t\t\t};\n\t\t\tvar key = ++this._key;\n\t\t\tcallbacks[key] = callback;\n\n\t\t\t// add 立即检测，防止首屏元素问题\n\t\t\tif (self._windowRegion) {\n\t\t\t\tself._loadItem(key, callback);\n\t\t\t} else {\n\t\t\t\tself.refresh();\n\t\t\t}\n\t\t},\n\t\taddElements: function(elements) {\n\t\t\tvar self = this;\n\t\t\tself._counter = self._counter || 0;\n\t\t\tvar lazyloads = [];\n\t\t\tif (!elements && self.options.selector) {\n\t\t\t\tlazyloads = self.container.querySelectorAll(self.options.selector);\n\t\t\t} else {\n\t\t\t\t$.each(elements, function(index, el) {\n\t\t\t\t\tlazyloads = lazyloads.concat($.qsa(self.options.selector, el));\n\t\t\t\t});\n\t\t\t}\n\t\t\t$.each(lazyloads, function(index, el) {\n\t\t\t\tif (!el.getAttribute('data-lazyload-id')) {\n\t\t\t\t\tif (self.addElement(el)) {\n\t\t\t\t\t\tel.setAttribute('data-lazyload-id', mid++);\n\t\t\t\t\t\tself.addCallback(el, self.handle);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\taddElement: function(el) {\n\t\t\treturn true;\n\t\t},\n\t\thandle: function() {\n\t\t\t//throw new Error('需子类实现');\n\t\t},\n\t\trefresh: function(check) {\n\t\t\tif (check) { //检查新的lazyload\n\t\t\t\tthis.addElements();\n\t\t\t}\n\t\t\tthis._loadFn();\n\t\t},\n\t\tpause: function() {\n\t\t\tvar load = this._loadFn;\n\t\t\tif (this._destroyed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twindow.removeEventListener('scroll', load);\n\t\t\twindow.removeEventListener($.EVENT_MOVE, load);\n\t\t\twindow.removeEventListener('resize', load);\n\t\t\tif (this._containerIsNotDocument) {\n\t\t\t\tthis.container.removeEventListener('scrollend', load);\n\t\t\t\tthis.container.removeEventListener('scroll', load);\n\t\t\t\tthis.container.removeEventListener($.EVENT_MOVE, load);\n\t\t\t}\n\t\t},\n\t\tresume: function() {\n\t\t\tvar load = this._loadFn;\n\t\t\tif (this._destroyed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twindow.addEventListener('scroll', load, false);\n\t\t\twindow.addEventListener($.EVENT_MOVE, load, false);\n\t\t\twindow.addEventListener('resize', load, false);\n\t\t\tif (this._containerIsNotDocument) {\n\t\t\t\tthis.container.addEventListener('scrollend', load, false);\n\t\t\t\tthis.container.addEventListener('scroll', load, false);\n\t\t\t\tthis.container.addEventListener($.EVENT_MOVE, load, false);\n\t\t\t}\n\t\t},\n\t\tdestroy: function() {\n\t\t\tvar self = this;\n\t\t\tself.pause();\n\t\t\tself._callbacks = {};\n\t\t\t$.trigger(this.container, 'destroy', self);\n\t\t\tself._destroyed = 1;\n\t\t}\n\t});\n})(mui, window, document);"]}