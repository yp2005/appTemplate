{"version":3,"sources":["src\\static\\js\\mui.imageViewer.js"],"names":[],"mappings":"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","file":"mui.imageViewer.js","sourceRoot":"C:/Users/dell/AppData/Roaming/HBuilder/userprofiles/18710095921@163.com/jxddH5PlusApp/unpackage","sourcesContent":["/**\n * 图片预览组件\n * varstion 0.4.0\n * by Houfeng\n * Houfeng@DCloud.io\n */\n\n(function($, document) {\n\n\t$.init({\n\t\tgestureConfig: {\n\t\t\ttap: true, //默认为true\n\t\t\tdoubletap: true, //默认为false\n\t\t\tlongtap: true, //默认为false\n\t\t\tswipe: true, //默认为true\n\t\t\tdrag: true, //默认为true\n\t\t\thold: true, //默认为false，不监听\n\t\t\trelease: true //默认为false，不监听\n\t\t}\n\t});\n\n\tvar touchSupport = ('ontouchstart' in document);\n\tvar tapEventName = touchSupport ? 'tap' : 'click';\n\tvar enterEventName = touchSupport ? 'tap' : 'click';\n\tvar imageClassName = $.className('image');\n\n\n\t//创建DOM (此函数是否可放在 mui.js 中)\n\t$.dom = function(str) {\n\t\tif (!$.__create_dom_div__) {\n\t\t\t$.__create_dom_div__ = document.createElement('div');\n\t\t}\n\t\t$.__create_dom_div__.innerHTML = str;\n\t\treturn $.__create_dom_div__.childNodes;\n\t};\n\n\t//图片预览组件类\n\tvar ImageViewer = $.ImageViewer = $.Class.extend({\n\t\t//构造函数\n\t\tinit: function(selector, options) {\n\t\t\tvar self = this;\n\t\t\tself.options = options || {};\n\t\t\tself.selector = selector || 'img';\n\t\t\tif (self.options.dbl) {\n\t\t\t\tenterEventName = touchSupport ? 'doubletap' : 'dblclick';\n\t\t\t}\n\t\t\tself.findAllImage();\n\t\t\tself.createViewer();\n\t\t\tself.bindEvent();\n\t\t},\n\t\t//创建图片预览组件的整体 UI\n\t\tcreateViewer: function() {\n\t\t\tvar self = this;\n\t\t\tself.viewer = $.dom(\"<div class='mui-imageviewer'><div class='mui-imageviewer-mask'></div><div class='mui-imageviewer-header'><i class='mui-icon mui-icon-closeempty mui-imageviewer-close'></i><span class='mui-imageviewer-state'></span></div><i class='mui-icon mui-icon-arrowleft  mui-imageviewer-left'></i><i class='mui-icon mui-icon-arrowright mui-imageviewer-right'></i></div>\");\n\t\t\tself.viewer = self.viewer[0] || self.viewer;\n\t\t\t//self.viewer.style.height = screen.height;\n\t\t\tself.closeButton = self.viewer.querySelector('.mui-imageviewer-close');\n\t\t\tself.state = self.viewer.querySelector('.mui-imageviewer-state');\n\t\t\tself.leftButton = self.viewer.querySelector('.mui-imageviewer-left');\n\t\t\tself.rightButton = self.viewer.querySelector('.mui-imageviewer-right');\n\t\t\tself.mask = self.viewer.querySelector('.mui-imageviewer-mask');\n\t\t\tdocument.body.appendChild(self.viewer);\n\t\t},\n\t\t//查找所有符合的图片\n\t\tfindAllImage: function() {\n\t\t\tvar self = this;\n\t\t\tself.images = [].slice.call($(self.selector));\n\t\t},\n\t\t//检查图片是否为启动预览的图片\n\t\tcheckImage: function(target) {\n\t\t\tvar self = this;\n\t\t\tif (target.tagName !== 'IMG') return false;\n\t\t\treturn self.images.some(function(image) {\n\t\t\t\treturn image == target;\n\t\t\t});\n\t\t},\n\t\t//绑定事件\n\t\tbindEvent: function() {\n\t\t\tvar self = this;\n\t\t\t//绑定图片 tap 事件\n\t\t\tdocument.addEventListener(enterEventName, function(event) {\n\t\t\t\tif (!self.viewer) return;\n\t\t\t\tvar target = event.target;\n\t\t\t\tif (!self.checkImage(target)) return;\n\t\t\t\tself.viewer.style.display = 'block';\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.viewer.style.opacity = 1;\n\t\t\t\t}, 0);\n\t\t\t\tself.index = self.images.indexOf(target);\n\t\t\t\tself.currentItem = self.createImage(self.index);\n\t\t\t}, false);\n\t\t\t//关系按钮事件\n\t\t\tself.closeButton.addEventListener(tapEventName, function(event) {\n\t\t\t\tself.viewer.style.opacity = 0;\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.viewer.style.display = 'none';\n\t\t\t\t\tself.disposeImage(true);\n\t\t\t\t}, 600);\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.cancelBubble = true;\n\t\t\t}, false);\n\t\t\t//处理左右按钮\n\t\t\tself.leftButton.addEventListener(tapEventName, function() {\n\t\t\t\tself.prev();\n\t\t\t}, false);\n\t\t\tself.rightButton.addEventListener(tapEventName, function() {\n\t\t\t\tself.next();\n\t\t\t}, false);\n\t\t\t//处理划动\n\t\t\tself.mask.addEventListener($.EVENT_MOVE, function(event) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.cancelBubble = true;\n\t\t\t}, false);\n\t\t\tself.viewer.addEventListener('swipeleft', function(event) {\n\t\t\t\tif (self.scaleValue == 1) self.next();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.cancelBubble = true;\n\t\t\t}, false);\n\t\t\tself.viewer.addEventListener('swiperight', function(event) {\n\t\t\t\tif (self.scaleValue == 1) self.prev();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.cancelBubble = true;\n\t\t\t}, false);\n\t\t\t//处理缩放开始\n\t\t\tself.viewer.addEventListener($.EVENT_START, function(event) {\n\t\t\t\tvar touches = event.touches;\n\t\t\t\tif (touches.length == 2) {\n\t\t\t\t\tvar p1 = touches[0];\n\t\t\t\t\tvar p2 = touches[1];\n\t\t\t\t\tvar x = p1.pageX - p2.pageX; //x1-x2\n\t\t\t\t\tvar y = p1.pageY - p2.pageY; //y1-y2\n\t\t\t\t\tself.scaleStart = Math.sqrt(x * x + y * y);\n\t\t\t\t\tself.isMultiTouch = true;\n\t\t\t\t} else if (touches.length = 1) {\n\t\t\t\t\tself.dragStart = touches[0];\n\t\t\t\t}\n\t\t\t}, false);\n\t\t\tself.viewer.addEventListener($.EVENT_MOVE, function(event) {\n\t\t\t\tvar img = self.currentItem.querySelector('img');\n\t\t\t\tvar touches = event.changedTouches;\n\t\t\t\tif (touches.length == 2) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.cancelBubble = true;\n\t\t\t\t\tvar p1 = touches[0];\n\t\t\t\t\tvar p2 = touches[1];\n\t\t\t\t\tvar x = p1.pageX - p2.pageX;\n\t\t\t\t\tvar y = p1.pageY - p2.pageY;\n\t\t\t\t\tself.scaleEnd = Math.sqrt(x * x + y * y);\n\t\t\t\t\tself._scaleValue = (self.scaleValue * (self.scaleEnd / self.scaleStart));\n\t\t\t\t\t//self.state.innerText = self._scaleValue;\n\t\t\t\t\timg.style.webkitTransform = \"scale(\" + self._scaleValue + \",\" + self._scaleValue + \") \"; // + \" translate(\" + self.dragX || 0 + \"px,\" + self.dragY || 0 + \"px)\";\n\t\t\t\t} else if (!self.isMultiTouch && touches.length == 1 && self.scaleValue != 1) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.cancelBubble = true;\n\t\t\t\t\tself.dragEnd = touches[0];\n\t\t\t\t\tself._dragX = self.dragX + (self.dragEnd.pageX - self.dragStart.pageX);\n\t\t\t\t\tself._dragY = self.dragY + (self.dragEnd.pageY - self.dragStart.pageY);\n\t\t\t\t\timg.style.marginLeft = self._dragX + 'px';\n\t\t\t\t\timg.style.marginTop = self._dragY + 'px';\n\t\t\t\t\t//img.style.transform = \"translate(\" + self._dragX + \"px,\" + self._dragY + \"px) \" + \" scale(\" + self.scaleValue || 1 + \",\" + self.scaleValue || 1 + \")\";\n\t\t\t\t}\n\t\t\t}, false);\n\t\t\tself.viewer.addEventListener($.EVENT_END, function() {\n\t\t\t\tself.scaleValue = self._scaleValue || self.scaleValue;\n\t\t\t\tself._scaleValue = null;\n\t\t\t\tself.dragX = self._dragX;\n\t\t\t\tself.dragY = self._dragY;\n\t\t\t\tself._dragX = null;\n\t\t\t\tself._dragY = null;\n\t\t\t\tvar touches = event.touches;\n\t\t\t\tself.isMultiTouch = (touches.length != 0);\n\t\t\t});\n\t\t\t// doubletap 好像不能用\n\t\t\tself.viewer.addEventListener('doubletap', function() {\n\t\t\t\tvar img = self.currentItem.querySelector('img');\n\t\t\t\tif (self.scaleValue === 1) {\n\t\t\t\t\tself.scaleValue = 2;\n\t\t\t\t} else {\n\t\t\t\t\tself.scaleValue = 1;\n\t\t\t\t}\n\t\t\t\tself.dragX = 0;\n\t\t\t\tself.dragY = 0;\n\t\t\t\timg.style.marginLeft = self.dragX + 'px';\n\t\t\t\timg.style.marginTop = self.dragY + 'px';\n\t\t\t\timg.style.webkitTransform = \"scale(\" + self.scaleValue + \",\" + self.scaleValue + \") \"; //+ \" translate(\" + self.dragX || 0 + \"px,\" + self.dragY || 0 + \"px)\";\n\t\t\t\tself.viewer.__tap_num = 0;\n\t\t\t}, false);\n\t\t\t//处理缩放结束\n\t\t},\n\t\t//下一张图片\n\t\tnext: function() {\n\t\t\tvar self = this;\n\t\t\tself.mask.style.display = 'block';\n\t\t\tself.index++;\n\t\t\tvar newItem = self.createImage(self.index, 'right');\n\t\t\tsetTimeout(function() {\n\t\t\t\tself.currentItem.classList.remove('mui-imageviewer-item-center');\n\t\t\t\tself.currentItem.classList.add('mui-imageviewer-item-left');\n\t\t\t\tnewItem.classList.remove('mui-imageviewer-item-right');\n\t\t\t\tnewItem.classList.add('mui-imageviewer-item-center');\n\t\t\t\tself.oldItem = self.currentItem;\n\t\t\t\tself.currentItem = newItem;\n\t\t\t\t// TODO: 临时,稍候将调整\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.disposeImage();\n\t\t\t\t\tself.mask.style.display = 'none';\n\t\t\t\t}, 600);\n\t\t\t}, 25);\n\t\t},\n\t\t//上一张图片\n\t\tprev: function() {\n\t\t\tvar self = this;\n\t\t\tself.mask.style.display = 'block';\n\t\t\tself.index--;\n\t\t\tvar newItem = self.createImage(self.index, 'left');\n\t\t\tsetTimeout(function() {\n\t\t\t\tself.currentItem.classList.remove('mui-imageviewer-item-center');\n\t\t\t\tself.currentItem.classList.add('mui-imageviewer-item-right');\n\t\t\t\tnewItem.classList.remove('mui-imageviewer-item-left');\n\t\t\t\tnewItem.classList.add('mui-imageviewer-item-center');\n\t\t\t\tself.oldItem = self.currentItem;\n\t\t\t\tself.currentItem = newItem;\n\t\t\t\t// TODO: 临时,稍候将调整\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.disposeImage();\n\t\t\t\t\tself.mask.style.display = 'none';\n\t\t\t\t}, 600);\n\t\t\t}, 25);\n\t\t},\n\t\t//释放不显示的图片\n\t\tdisposeImage: function(all) {\n\t\t\tvar sel = '.mui-imageviewer-item-left,.mui-imageviewer-item-right';\n\t\t\tif (all) sel += \",.mui-imageviewer-item\";\n\t\t\tvar willdisposes = $(sel);\n\t\t\twilldisposes.each(function(i, item) {\n\t\t\t\tif (item.parentNode && item.parentNode.removeChild)\n\t\t\t\t\titem.parentNode.removeChild(item, true);\n\t\t\t});\n\t\t},\n\t\t//创建一个图片\n\t\tcreateImage: function(index, type) {\n\t\t\tvar self = this;\n\t\t\ttype = type || 'center';\n\t\t\tif (index < 0) index = self.images.length - 1;\n\t\t\tif (index > self.images.length - 1) index = 0;\n\t\t\tself.index = index;\n\t\t\tvar item = $.dom(\"<div class='mui-imageviewer-item'></div>\")[0];\n\t\t\titem.appendChild($.dom('<span><img src=\"' + self.images[self.index].src + '\"/></span>')[0]);\n\t\t\titem.classList.add('mui-imageviewer-item-' + type);\n\t\t\tself.viewer.appendChild(item);\n\t\t\tself.state.innerText = (self.index + 1) + \"/\" + self.images.length;\n\t\t\t//重置初始缩放比例\n\t\t\tself.scaleValue = 1;\n\t\t\tself.dragX = 0;\n\t\t\tself.dragY = 0;\n\t\t\treturn item;\n\t\t}\n\t});\n\n\t$.imageViewer = function(selector, options) {\n\t\treturn new ImageViewer(selector, options);\n\t};\n\n\t$.ready(function() {\n\t\t$.imageViewer('.' + imageClassName);\n\t});\n\n}(mui, document));"]}